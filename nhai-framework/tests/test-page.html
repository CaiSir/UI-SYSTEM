<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NHAI æ¡†æ¶æµ‹è¯•</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            line-height: 1.6;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .test-section {
            margin: 30px 0;
            padding: 20px;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
        }
        
        .test-section h3 {
            margin-top: 0;
            color: #333;
            border-bottom: 2px solid #007bff;
            padding-bottom: 10px;
        }
        
        .test-button {
            padding: 8px 16px;
            margin: 5px;
            border: 1px solid #007bff;
            background: white;
            color: #007bff;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .test-button:hover {
            background: #007bff;
            color: white;
        }
        
        .test-result {
            margin: 15px 0;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 4px;
            border-left: 3px solid #28a745;
        }
        
        .error {
            border-left-color: #dc3545;
            background: #f8d7da;
            color: #721c24;
        }
        
        .success {
            border-left-color: #28a745;
            background: #d4edda;
            color: #155724;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¯ NHAI æ¡†æ¶æµ‹è¯•é¡µé¢</h1>
        <p>æµ‹è¯• NHAI æ¡†æ¶çš„æ ¸å¿ƒåŠŸèƒ½æ˜¯å¦æ­£å¸¸å·¥ä½œ</p>
        
        <div class="test-section">
            <h3>ğŸ“¦ æ¡†æ¶åŠ è½½æµ‹è¯•</h3>
            <button class="test-button" onclick="testFrameworkLoading()">æµ‹è¯•æ¡†æ¶åŠ è½½</button>
            <div id="loading-result" class="test-result" style="display: none;"></div>
        </div>
        
        <div class="test-section">
            <h3>ğŸ”§ ç»„ä»¶åˆ›å»ºæµ‹è¯•</h3>
            <button class="test-button" onclick="testComponentCreation()">æµ‹è¯•ç»„ä»¶åˆ›å»º</button>
            <div id="component-result" class="test-result" style="display: none;"></div>
        </div>
        
        <div class="test-section">
            <h3>ğŸ¨ åŠ¨æ€ç»„ä»¶æµ‹è¯•</h3>
            <button class="test-button" onclick="testDynamicComponents()">æµ‹è¯•åŠ¨æ€ç»„ä»¶</button>
            <div id="dynamic-result" class="test-result" style="display: none;"></div>
        </div>
        
        <div class="test-section">
            <h3>ğŸ“Š æ€§èƒ½æµ‹è¯•</h3>
            <button class="test-button" onclick="testPerformance()">æµ‹è¯•æ€§èƒ½</button>
            <div id="performance-result" class="test-result" style="display: none;"></div>
        </div>
        
        <div class="test-section">
            <h3>ğŸŒ æµè§ˆå™¨å…¼å®¹æ€§æµ‹è¯•</h3>
            <button class="test-button" onclick="testBrowserCompatibility()">æµ‹è¯•å…¼å®¹æ€§</button>
            <div id="compatibility-result" class="test-result" style="display: none;"></div>
        </div>
    </div>

    <!-- åŠ è½½ NHAI æ¡†æ¶ -->
    <script type="module">
        // æ¨¡æ‹Ÿ NHAI æ¡†æ¶çš„æ ¸å¿ƒåŠŸèƒ½
        window.NHAI = {
            // æ¡†æ¶ç‰ˆæœ¬
            version: '1.0.0',
            
            // æ ¸å¿ƒç»„ä»¶
            Components: {
                Button: class NHAIButton {
                    constructor(props = {}) {
                        this.props = props
                    }
                    
                    render() {
                        return {
                            tag: 'button',
                            props: {
                                ...this.props,
                                style: {
                                    padding: '8px 16px',
                                    border: '1px solid #007bff',
                                    background: 'white',
                                    color: '#007bff',
                                    borderRadius: '4px',
                                    cursor: 'pointer',
                                    ...this.props.style
                                }
                            },
                            children: this.props.children || 'NHAI Button'
                        }
                    }
                },
                
                TextButton: class NHAITextButton {
                    constructor(props = {}) {
                        this.props = props
                    }
                    
                    render() {
                        return {
                            tag: 'button',
                            props: {
                                ...this.props,
                                style: {
                                    padding: '6px 12px',
                                    border: 'none',
                                    background: 'transparent',
                                    color: '#007bff',
                                    cursor: 'pointer',
                                    textDecoration: 'underline',
                                    ...this.props.style
                                }
                            },
                            children: this.props.children || 'NHAI Text Button'
                        }
                    }
                }
            },
            
            // åŠ¨æ€ç»„ä»¶ç³»ç»Ÿ
            DynamicComponents: {
                Registry: {
                    components: new Map(),
                    
                    registerComponent(name, componentClass) {
                        this.components.set(name, componentClass)
                    },
                    
                    createComponent(name, props = {}) {
                        const ComponentClass = this.components.get(name)
                        if (!ComponentClass) {
                            throw new Error(`Component "${name}" not found`)
                        }
                        return new ComponentClass(props)
                    },
                    
                    hasComponent(name) {
                        return this.components.has(name)
                    }
                },
                
                Renderer: {
                    renderDynamicComponent(componentName, props = {}) {
                        try {
                            const component = window.NHAI.DynamicComponents.Registry.createComponent(componentName, props)
                            return component.render()
                        } catch (error) {
                            return {
                                tag: 'div',
                                props: {
                                    style: {
                                        padding: '10px',
                                        backgroundColor: '#ffebee',
                                        border: '1px solid #f44336',
                                        borderRadius: '4px',
                                        color: '#c62828'
                                    }
                                },
                                children: [`Error: ${error.message}`]
                            }
                        }
                    }
                }
            },
            
            // å·¥å…·å‡½æ•°
            Utils: {
                createElement(tag, props = {}, children = []) {
                    const element = document.createElement(tag)
                    
                    // è®¾ç½®å±æ€§
                    Object.keys(props).forEach(key => {
                        if (key === 'style' && typeof props[key] === 'object') {
                            Object.assign(element.style, props[key])
                        } else if (key === 'className') {
                            element.className = props[key]
                        } else if (key.startsWith('on')) {
                            element.addEventListener(key.slice(2).toLowerCase(), props[key])
                        } else {
                            element.setAttribute(key, props[key])
                        }
                    })
                    
                    // æ·»åŠ å­å…ƒç´ 
                    if (Array.isArray(children)) {
                        children.forEach(child => {
                            if (typeof child === 'string') {
                                element.appendChild(document.createTextNode(child))
                            } else if (child && typeof child === 'object') {
                                const childElement = window.NHAI.Utils.createElement(child.tag, child.props, child.children)
                                element.appendChild(childElement)
                            }
                        })
                    } else if (typeof children === 'string') {
                        element.appendChild(document.createTextNode(children))
                    }
                    
                    return element
                },
                
                renderComponent(component) {
                    if (component && typeof component.render === 'function') {
                        const result = component.render()
                        return window.NHAI.Utils.createElement(result.tag, result.props, result.children)
                    }
                    return document.createElement('div')
                }
            }
        }
        
        // å…¨å±€æµ‹è¯•å‡½æ•°
        window.testFrameworkLoading = function() {
            const resultDiv = document.getElementById('loading-result')
            resultDiv.style.display = 'block'
            
            try {
                if (window.NHAI && window.NHAI.version) {
                    resultDiv.className = 'test-result success'
                    resultDiv.innerHTML = `
                        <strong>âœ… æ¡†æ¶åŠ è½½æˆåŠŸï¼</strong><br>
                        ç‰ˆæœ¬: ${window.NHAI.version}<br>
                        ç»„ä»¶æ•°é‡: ${Object.keys(window.NHAI.Components).length}<br>
                        åŠ¨æ€ç»„ä»¶ç³»ç»Ÿ: ${window.NHAI.DynamicComponents ? 'å·²åŠ è½½' : 'æœªåŠ è½½'}
                    `
                } else {
                    throw new Error('NHAI æ¡†æ¶æœªæ­£ç¡®åŠ è½½')
                }
            } catch (error) {
                resultDiv.className = 'test-result error'
                resultDiv.innerHTML = `<strong>âŒ æ¡†æ¶åŠ è½½å¤±è´¥:</strong> ${error.message}`
            }
        }
        
        window.testComponentCreation = function() {
            const resultDiv = document.getElementById('component-result')
            resultDiv.style.display = 'block'
            
            try {
                // æµ‹è¯•æŒ‰é’®ç»„ä»¶
                const button = new window.NHAI.Components.Button({
                    children: 'æµ‹è¯•æŒ‰é’®',
                    onClick: () => alert('æŒ‰é’®è¢«ç‚¹å‡»äº†ï¼')
                })
                
                const buttonElement = window.NHAI.Utils.renderComponent(button)
                buttonElement.style.margin = '10px'
                
                // æµ‹è¯•æ–‡æœ¬æŒ‰é’®ç»„ä»¶
                const textButton = new window.NHAI.Components.TextButton({
                    children: 'æµ‹è¯•æ–‡æœ¬æŒ‰é’®',
                    onClick: () => alert('æ–‡æœ¬æŒ‰é’®è¢«ç‚¹å‡»äº†ï¼')
                })
                
                const textButtonElement = window.NHAI.Utils.renderComponent(textButton)
                textButtonElement.style.margin = '10px'
                
                resultDiv.className = 'test-result success'
                resultDiv.innerHTML = `
                    <strong>âœ… ç»„ä»¶åˆ›å»ºæˆåŠŸï¼</strong><br>
                    å·²åˆ›å»ºæŒ‰é’®ç»„ä»¶å’Œæ–‡æœ¬æŒ‰é’®ç»„ä»¶
                `
                resultDiv.appendChild(buttonElement)
                resultDiv.appendChild(textButtonElement)
                
            } catch (error) {
                resultDiv.className = 'test-result error'
                resultDiv.innerHTML = `<strong>âŒ ç»„ä»¶åˆ›å»ºå¤±è´¥:</strong> ${error.message}`
            }
        }
        
        window.testDynamicComponents = function() {
            const resultDiv = document.getElementById('dynamic-result')
            resultDiv.style.display = 'block'
            
            try {
                // æ³¨å†ŒåŠ¨æ€ç»„ä»¶
                window.NHAI.DynamicComponents.Registry.registerComponent('CustomButton', class {
                    constructor(props) {
                        this.props = props
                    }
                    
                    render() {
                        return {
                            tag: 'button',
                            props: {
                                ...this.props,
                                style: {
                                    padding: '10px 20px',
                                    backgroundColor: '#28a745',
                                    color: 'white',
                                    border: 'none',
                                    borderRadius: '6px',
                                    cursor: 'pointer',
                                    ...this.props.style
                                }
                            },
                            children: this.props.children || 'åŠ¨æ€æŒ‰é’®'
                        }
                    }
                })
                
                // åˆ›å»ºåŠ¨æ€ç»„ä»¶
                const dynamicComponent = window.NHAI.DynamicComponents.Renderer.renderDynamicComponent('CustomButton', {
                    children: 'åŠ¨æ€åˆ›å»ºçš„æŒ‰é’®',
                    onClick: () => alert('åŠ¨æ€æŒ‰é’®è¢«ç‚¹å‡»äº†ï¼')
                })
                
                const dynamicElement = window.NHAI.Utils.createElement(
                    dynamicComponent.tag, 
                    dynamicComponent.props, 
                    dynamicComponent.children
                )
                dynamicElement.style.margin = '10px'
                
                resultDiv.className = 'test-result success'
                resultDiv.innerHTML = `
                    <strong>âœ… åŠ¨æ€ç»„ä»¶æµ‹è¯•æˆåŠŸï¼</strong><br>
                    å·²æ³¨å†Œå¹¶åˆ›å»ºåŠ¨æ€ç»„ä»¶
                `
                resultDiv.appendChild(dynamicElement)
                
            } catch (error) {
                resultDiv.className = 'test-result error'
                resultDiv.innerHTML = `<strong>âŒ åŠ¨æ€ç»„ä»¶æµ‹è¯•å¤±è´¥:</strong> ${error.message}`
            }
        }
        
        window.testPerformance = function() {
            const resultDiv = document.getElementById('performance-result')
            resultDiv.style.display = 'block'
            
            try {
                const startTime = performance.now()
                
                // åˆ›å»ºå¤§é‡ç»„ä»¶æµ‹è¯•æ€§èƒ½
                const components = []
                for (let i = 0; i < 100; i++) {
                    const button = new window.NHAI.Components.Button({
                        children: `æŒ‰é’® ${i + 1}`,
                        onClick: () => console.log(`æŒ‰é’® ${i + 1} è¢«ç‚¹å‡»`)
                    })
                    components.push(button)
                }
                
                const endTime = performance.now()
                const duration = endTime - startTime
                
                resultDiv.className = 'test-result success'
                resultDiv.innerHTML = `
                    <strong>âœ… æ€§èƒ½æµ‹è¯•å®Œæˆï¼</strong><br>
                    åˆ›å»º 100 ä¸ªç»„ä»¶è€—æ—¶: ${duration.toFixed(2)}ms<br>
                    å¹³å‡æ¯ä¸ªç»„ä»¶: ${(duration / 100).toFixed(2)}ms<br>
                    æ€§èƒ½è¯„çº§: ${duration < 10 ? 'ä¼˜ç§€' : duration < 50 ? 'è‰¯å¥½' : 'ä¸€èˆ¬'}
                `
                
            } catch (error) {
                resultDiv.className = 'test-result error'
                resultDiv.innerHTML = `<strong>âŒ æ€§èƒ½æµ‹è¯•å¤±è´¥:</strong> ${error.message}`
            }
        }
        
        window.testBrowserCompatibility = function() {
            const resultDiv = document.getElementById('compatibility-result')
            resultDiv.style.display = 'block'
            
            try {
                const features = {
                    'ES6 Classes': typeof class {} === 'function',
                    'Arrow Functions': (() => true)(),
                    'Template Literals': `test` === 'test',
                    'Destructuring': (() => { const {a} = {a: 1}; return a === 1 })(),
                    'Map': typeof Map === 'function',
                    'Promise': typeof Promise === 'function',
                    'Fetch': typeof fetch === 'function',
                    'Local Storage': typeof localStorage !== 'undefined',
                    'Session Storage': typeof sessionStorage !== 'undefined'
                }
                
                const supportedFeatures = Object.values(features).filter(Boolean).length
                const totalFeatures = Object.keys(features).length
                const compatibility = (supportedFeatures / totalFeatures * 100).toFixed(1)
                
                const featureList = Object.entries(features)
                    .map(([name, supported]) => 
                        `<li style="color: ${supported ? '#28a745' : '#dc3545'}">
                            ${supported ? 'âœ…' : 'âŒ'} ${name}
                        </li>`
                    ).join('')
                
                resultDiv.className = 'test-result success'
                resultDiv.innerHTML = `
                    <strong>âœ… æµè§ˆå™¨å…¼å®¹æ€§æµ‹è¯•å®Œæˆï¼</strong><br>
                    å…¼å®¹æ€§è¯„åˆ†: ${compatibility}%<br>
                    <ul style="margin: 10px 0; padding-left: 20px;">
                        ${featureList}
                    </ul>
                `
                
            } catch (error) {
                resultDiv.className = 'test-result error'
                resultDiv.innerHTML = `<strong>âŒ å…¼å®¹æ€§æµ‹è¯•å¤±è´¥:</strong> ${error.message}`
            }
        }
        
        // é¡µé¢åŠ è½½å®Œæˆåè‡ªåŠ¨è¿è¡ŒåŸºç¡€æµ‹è¯•
        document.addEventListener('DOMContentLoaded', function() {
            console.log('NHAI æ¡†æ¶æµ‹è¯•é¡µé¢å·²åŠ è½½')
            console.log('NHAI ç‰ˆæœ¬:', window.NHAI.version)
        })
    </script>
</body>
</html>
